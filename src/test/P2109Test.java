package test;

import main.P2109;

import org.junit.Before;
import org.junit.Test;


public class P2109Test {
    // the results are compared to the MATLAB/Excel implementation of Recommendation ITU-R P.2109
    // the test is passed when the results for transmission loss are within 0.01 dB of difference
    // different location percentages, frequencies, distances, and environment categories are tested
    //     Rev   Date        Author                          Description
    //     -------------------------------------------------------------------------------
    //     v0    05MAY17     Ivica Stevanovic, OFCOM         Initial version in Java




    TestUtil util;

    @Before
    public void setup() {

        util = new TestUtil( 0.01 );
    }

    @Test
    public void test1() {
        P2109 calculator = new P2109();
        double[] p = new double[142];
        double th = 0.000000;
        double f = 28.000000;
        int cl = 1;
        p[0] = 0.000010;
        p[1] = 0.000013;
        p[2] = 0.000016;
        p[3] = 0.000020;
        p[4] = 0.000025;
        p[5] = 0.000032;
        p[6] = 0.000040;
        p[7] = 0.000050;
        p[8] = 0.000063;
        p[9] = 0.000079;
        p[10] = 0.000100;
        p[11] = 0.000126;
        p[12] = 0.000158;
        p[13] = 0.000200;
        p[14] = 0.000251;
        p[15] = 0.000316;
        p[16] = 0.000398;
        p[17] = 0.000501;
        p[18] = 0.000631;
        p[19] = 0.000794;
        p[20] = 0.001000;
        p[21] = 0.001259;
        p[22] = 0.001585;
        p[23] = 0.001995;
        p[24] = 0.002512;
        p[25] = 0.003162;
        p[26] = 0.003981;
        p[27] = 0.005012;
        p[28] = 0.006310;
        p[29] = 0.007943;
        p[30] = 0.010000;
        p[31] = 0.012589;
        p[32] = 0.015849;
        p[33] = 0.019953;
        p[34] = 0.025119;
        p[35] = 0.031623;
        p[36] = 0.039811;
        p[37] = 0.050119;
        p[38] = 0.063096;
        p[39] = 0.079433;
        p[40] = 0.100000;
        p[41] = 0.125892;
        p[42] = 0.158489;
        p[43] = 0.199526;
        p[44] = 0.251189;
        p[45] = 0.316228;
        p[46] = 0.398107;
        p[47] = 0.501187;
        p[48] = 0.630957;
        p[49] = 0.794328;
        p[50] = 1.000000;
        p[51] = 1.258925;
        p[52] = 1.584893;
        p[53] = 1.995262;
        p[54] = 2.511886;
        p[55] = 3.162278;
        p[56] = 3.981072;
        p[57] = 5.011872;
        p[58] = 6.309573;
        p[59] = 7.943282;
        p[60] = 10.000000;
        p[61] = 12.589250;
        p[62] = 15.848930;
        p[63] = 19.952620;
        p[64] = 20.417380;
        p[65] = 20.892960;
        p[66] = 21.379620;
        p[67] = 21.877620;
        p[68] = 22.387210;
        p[69] = 22.908680;
        p[70] = 23.442290;
        p[71] = 23.988330;
        p[72] = 24.547090;
        p[73] = 25.118860;
        p[74] = 25.703960;
        p[75] = 26.302680;
        p[76] = 26.915350;
        p[77] = 27.542290;
        p[78] = 28.183830;
        p[79] = 28.840320;
        p[80] = 29.512090;
        p[81] = 30.199520;
        p[82] = 30.902950;
        p[83] = 31.622780;
        p[84] = 32.359370;
        p[85] = 33.113110;
        p[86] = 33.884420;
        p[87] = 34.673690;
        p[88] = 35.481340;
        p[89] = 36.307810;
        p[90] = 37.153520;
        p[91] = 38.018940;
        p[92] = 38.904510;
        p[93] = 39.810720;
        p[94] = 40.738030;
        p[95] = 41.686940;
        p[96] = 42.657950;
        p[97] = 43.651580;
        p[98] = 44.668360;
        p[99] = 45.708820;
        p[100] = 46.773510;
        p[101] = 47.863010;
        p[102] = 48.977880;
        p[103] = 50.118720;
        p[104] = 51.286140;
        p[105] = 52.480750;
        p[106] = 53.703180;
        p[107] = 54.954090;
        p[108] = 56.234130;
        p[109] = 57.543990;
        p[110] = 58.884370;
        p[111] = 60.255960;
        p[112] = 61.659500;
        p[113] = 63.095730;
        p[114] = 64.565420;
        p[115] = 66.069340;
        p[116] = 67.608300;
        p[117] = 69.183100;
        p[118] = 70.794580;
        p[119] = 72.443600;
        p[120] = 74.131020;
        p[121] = 75.857760;
        p[122] = 77.624710;
        p[123] = 79.432820;
        p[124] = 81.283050;
        p[125] = 83.176380;
        p[126] = 85.113800;
        p[127] = 87.096360;
        p[128] = 89.125090;
        p[129] = 91.201080;
        p[130] = 93.325430;
        p[131] = 95.499260;
        p[132] = 97.723720;
        p[133] = 97.949000;
        p[134] = 98.174790;
        p[135] = 98.401110;
        p[136] = 98.627950;
        p[137] = 98.855310;
        p[138] = 99.083190;
        p[139] = 99.311600;
        p[140] = 99.540540;
        p[141] = 99.770010;
        double[] expectedResult = new double[142];
        expectedResult[0] = -0.274524;
        expectedResult[1] = -0.242212;
        expectedResult[2] = -0.209367;
        expectedResult[3] = -0.175976;
        expectedResult[4] = -0.142026;
        expectedResult[5] = -0.107502;
        expectedResult[6] = -0.072389;
        expectedResult[7] = -0.036673;
        expectedResult[8] = -0.000336;
        expectedResult[9] = 0.036638;
        expectedResult[10] = 0.074267;
        expectedResult[11] = 0.112569;
        expectedResult[12] = 0.151564;
        expectedResult[13] = 0.191272;
        expectedResult[14] = 0.231715;
        expectedResult[15] = 0.272916;
        expectedResult[16] = 0.314898;
        expectedResult[17] = 0.357688;
        expectedResult[18] = 0.401312;
        expectedResult[19] = 0.445799;
        expectedResult[20] = 0.491179;
        expectedResult[21] = 0.537486;
        expectedResult[22] = 0.584755;
        expectedResult[23] = 0.633024;
        expectedResult[24] = 0.682334;
        expectedResult[25] = 0.732730;
        expectedResult[26] = 0.784262;
        expectedResult[27] = 0.836981;
        expectedResult[28] = 0.890948;
        expectedResult[29] = 0.946228;
        expectedResult[30] = 1.002893;
        expectedResult[31] = 1.061026;
        expectedResult[32] = 1.120719;
        expectedResult[33] = 1.182075;
        expectedResult[34] = 1.245216;
        expectedResult[35] = 1.310279;
        expectedResult[36] = 1.377424;
        expectedResult[37] = 1.446838;
        expectedResult[38] = 1.518744;
        expectedResult[39] = 1.593403;
        expectedResult[40] = 1.671132;
        expectedResult[41] = 1.752310;
        expectedResult[42] = 1.837401;
        expectedResult[43] = 1.926976;
        expectedResult[44] = 2.021738;
        expectedResult[45] = 2.122568;
        expectedResult[46] = 2.230569;
        expectedResult[47] = 2.347141;
        expectedResult[48] = 2.474064;
        expectedResult[49] = 2.613622;
        expectedResult[50] = 2.768759;
        expectedResult[51] = 2.943277;
        expectedResult[52] = 3.142113;
        expectedResult[53] = 3.371666;
        expectedResult[54] = 3.640216;
        expectedResult[55] = 3.958409;
        expectedResult[56] = 4.339784;
        expectedResult[57] = 4.801269;
        expectedResult[58] = 5.363526;
        expectedResult[59] = 6.050983;
        expectedResult[60] = 6.891431;
        expectedResult[61] = 7.915234;
        expectedResult[62] = 9.154599;
        expectedResult[63] = 10.643874;
        expectedResult[64] = 10.807991;
        expectedResult[65] = 10.975035;
        expectedResult[66] = 11.145052;
        expectedResult[67] = 11.318090;
        expectedResult[68] = 11.494191;
        expectedResult[69] = 11.673413;
        expectedResult[70] = 11.855802;
        expectedResult[71] = 12.041413;
        expectedResult[72] = 12.230302;
        expectedResult[73] = 12.422525;
        expectedResult[74] = 12.618149;
        expectedResult[75] = 12.817230;
        expectedResult[76] = 13.019839;
        expectedResult[77] = 13.226043;
        expectedResult[78] = 13.435917;
        expectedResult[79] = 13.649539;
        expectedResult[80] = 13.866986;
        expectedResult[81] = 14.088351;
        expectedResult[82] = 14.313718;
        expectedResult[83] = 14.543191;
        expectedResult[84] = 14.776865;
        expectedResult[85] = 15.014849;
        expectedResult[86] = 15.257265;
        expectedResult[87] = 15.504229;
        expectedResult[88] = 15.755873;
        expectedResult[89] = 16.012341;
        expectedResult[90] = 16.273777;
        expectedResult[91] = 16.540348;
        expectedResult[92] = 16.812220;
        expectedResult[93] = 17.089584;
        expectedResult[94] = 17.372632;
        expectedResult[95] = 17.661582;
        expectedResult[96] = 17.956664;
        expectedResult[97] = 18.258130;
        expectedResult[98] = 18.566252;
        expectedResult[99] = 18.881322;
        expectedResult[100] = 19.203658;
        expectedResult[101] = 19.533617;
        expectedResult[102] = 19.871572;
        expectedResult[103] = 20.217947;
        expectedResult[104] = 20.573200;
        expectedResult[105] = 20.937838;
        expectedResult[106] = 21.312416;
        expectedResult[107] = 21.697560;
        expectedResult[108] = 22.093957;
        expectedResult[109] = 22.502380;
        expectedResult[110] = 22.923698;
        expectedResult[111] = 23.358880;
        expectedResult[112] = 23.809034;
        expectedResult[113] = 24.275418;
        expectedResult[114] = 24.759479;
        expectedResult[115] = 25.262879;
        expectedResult[116] = 25.787556;
        expectedResult[117] = 26.335774;
        expectedResult[118] = 26.910219;
        expectedResult[119] = 27.514104;
        expectedResult[120] = 28.151306;
        expectedResult[121] = 28.826601;
        expectedResult[122] = 29.545923;
        expectedResult[123] = 30.316823;
        expectedResult[124] = 31.149109;
        expectedResult[125] = 32.055863;
        expectedResult[126] = 33.055125;
        expectedResult[127] = 34.172860;
        expectedResult[128] = 35.448484;
        expectedResult[129] = 36.946524;
        expectedResult[130] = 38.784615;
        expectedResult[131] = 41.217785;
        expectedResult[132] = 45.020550;
        expectedResult[133] = 45.564735;
        expectedResult[134] = 46.163599;
        expectedResult[135] = 46.830974;
        expectedResult[136] = 47.586772;
        expectedResult[137] = 48.461480;
        expectedResult[138] = 49.505366;
        expectedResult[139] = 50.810960;
        expectedResult[140] = 52.580990;
        expectedResult[141] = 55.440438;
        for (int pi = 0; pi < 142; pi++) {
            double result = calculator.bel(f,p[pi],cl,th);
            util.assertDoubleEquals(expectedResult[pi], result);
        }
    }


    @Test
    public void test2() {
        P2109 calculator = new P2109();
        double[] p = new double[142];
        double th = 0.000000;
        double f = 28.000000;
        int cl = 2;
        p[0] = 0.000010;
        p[1] = 0.000013;
        p[2] = 0.000016;
        p[3] = 0.000020;
        p[4] = 0.000025;
        p[5] = 0.000032;
        p[6] = 0.000040;
        p[7] = 0.000050;
        p[8] = 0.000063;
        p[9] = 0.000079;
        p[10] = 0.000100;
        p[11] = 0.000126;
        p[12] = 0.000158;
        p[13] = 0.000200;
        p[14] = 0.000251;
        p[15] = 0.000316;
        p[16] = 0.000398;
        p[17] = 0.000501;
        p[18] = 0.000631;
        p[19] = 0.000794;
        p[20] = 0.001000;
        p[21] = 0.001259;
        p[22] = 0.001585;
        p[23] = 0.001995;
        p[24] = 0.002512;
        p[25] = 0.003162;
        p[26] = 0.003981;
        p[27] = 0.005012;
        p[28] = 0.006310;
        p[29] = 0.007943;
        p[30] = 0.010000;
        p[31] = 0.012589;
        p[32] = 0.015849;
        p[33] = 0.019953;
        p[34] = 0.025119;
        p[35] = 0.031623;
        p[36] = 0.039811;
        p[37] = 0.050119;
        p[38] = 0.063096;
        p[39] = 0.079433;
        p[40] = 0.100000;
        p[41] = 0.125892;
        p[42] = 0.158489;
        p[43] = 0.199526;
        p[44] = 0.251189;
        p[45] = 0.316228;
        p[46] = 0.398107;
        p[47] = 0.501187;
        p[48] = 0.630957;
        p[49] = 0.794328;
        p[50] = 1.000000;
        p[51] = 1.258925;
        p[52] = 1.584893;
        p[53] = 1.995262;
        p[54] = 2.511886;
        p[55] = 3.162278;
        p[56] = 3.981072;
        p[57] = 5.011872;
        p[58] = 6.309573;
        p[59] = 7.943282;
        p[60] = 10.000000;
        p[61] = 12.589250;
        p[62] = 15.848930;
        p[63] = 19.952620;
        p[64] = 20.417380;
        p[65] = 20.892960;
        p[66] = 21.379620;
        p[67] = 21.877620;
        p[68] = 22.387210;
        p[69] = 22.908680;
        p[70] = 23.442290;
        p[71] = 23.988330;
        p[72] = 24.547090;
        p[73] = 25.118860;
        p[74] = 25.703960;
        p[75] = 26.302680;
        p[76] = 26.915350;
        p[77] = 27.542290;
        p[78] = 28.183830;
        p[79] = 28.840320;
        p[80] = 29.512090;
        p[81] = 30.199520;
        p[82] = 30.902950;
        p[83] = 31.622780;
        p[84] = 32.359370;
        p[85] = 33.113110;
        p[86] = 33.884420;
        p[87] = 34.673690;
        p[88] = 35.481340;
        p[89] = 36.307810;
        p[90] = 37.153520;
        p[91] = 38.018940;
        p[92] = 38.904510;
        p[93] = 39.810720;
        p[94] = 40.738030;
        p[95] = 41.686940;
        p[96] = 42.657950;
        p[97] = 43.651580;
        p[98] = 44.668360;
        p[99] = 45.708820;
        p[100] = 46.773510;
        p[101] = 47.863010;
        p[102] = 48.977880;
        p[103] = 50.118720;
        p[104] = 51.286140;
        p[105] = 52.480750;
        p[106] = 53.703180;
        p[107] = 54.954090;
        p[108] = 56.234130;
        p[109] = 57.543990;
        p[110] = 58.884370;
        p[111] = 60.255960;
        p[112] = 61.659500;
        p[113] = 63.095730;
        p[114] = 64.565420;
        p[115] = 66.069340;
        p[116] = 67.608300;
        p[117] = 69.183100;
        p[118] = 70.794580;
        p[119] = 72.443600;
        p[120] = 74.131020;
        p[121] = 75.857760;
        p[122] = 77.624710;
        p[123] = 79.432820;
        p[124] = 81.283050;
        p[125] = 83.176380;
        p[126] = 85.113800;
        p[127] = 87.096360;
        p[128] = 89.125090;
        p[129] = 91.201080;
        p[130] = 93.325430;
        p[131] = 95.499260;
        p[132] = 97.723720;
        p[133] = 97.949000;
        p[134] = 98.174790;
        p[135] = 98.401110;
        p[136] = 98.627950;
        p[137] = 98.855310;
        p[138] = 99.083190;
        p[139] = 99.311600;
        p[140] = 99.540540;
        p[141] = 99.770010;
        double[] expectedResult = new double[142];
        expectedResult[0] = -2.117045;
        expectedResult[1] = -2.065451;
        expectedResult[2] = -2.010732;
        expectedResult[3] = -1.952708;
        expectedResult[4] = -1.891187;
        expectedResult[5] = -1.825969;
        expectedResult[6] = -1.756847;
        expectedResult[7] = -1.683604;
        expectedResult[8] = -1.606015;
        expectedResult[9] = -1.523846;
        expectedResult[10] = -1.436858;
        expectedResult[11] = -1.344800;
        expectedResult[12] = -1.247416;
        expectedResult[13] = -1.144445;
        expectedResult[14] = -1.035616;
        expectedResult[15] = -0.920657;
        expectedResult[16] = -0.799288;
        expectedResult[17] = -0.671226;
        expectedResult[18] = -0.536187;
        expectedResult[19] = -0.393883;
        expectedResult[20] = -0.244025;
        expectedResult[21] = -0.086326;
        expectedResult[22] = 0.079504;
        expectedResult[23] = 0.253749;
        expectedResult[24] = 0.436693;
        expectedResult[25] = 0.628618;
        expectedResult[26] = 0.829800;
        expectedResult[27] = 1.040514;
        expectedResult[28] = 1.261030;
        expectedResult[29] = 1.491617;
        expectedResult[30] = 1.732542;
        expectedResult[31] = 1.984071;
        expectedResult[32] = 2.246474;
        expectedResult[33] = 2.520026;
        expectedResult[34] = 2.805011;
        expectedResult[35] = 3.101728;
        expectedResult[36] = 3.410495;
        expectedResult[37] = 3.731662;
        expectedResult[38] = 4.065616;
        expectedResult[39] = 4.412796;
        expectedResult[40] = 4.773713;
        expectedResult[41] = 5.148961;
        expectedResult[42] = 5.539258;
        expectedResult[43] = 5.945466;
        expectedResult[44] = 6.368650;
        expectedResult[45] = 6.810128;
        expectedResult[46] = 7.271555;
        expectedResult[47] = 7.755031;
        expectedResult[48] = 8.263240;
        expectedResult[49] = 8.799641;
        expectedResult[50] = 9.368721;
        expectedResult[51] = 9.976325;
        expectedResult[52] = 10.630096;
        expectedResult[53] = 11.340008;
        expectedResult[54] = 12.119016;
        expectedResult[55] = 12.983758;
        expectedResult[56] = 13.955202;
        expectedResult[57] = 15.059032;
        expectedResult[58] = 16.325494;
        expectedResult[59] = 17.788448;
        expectedResult[60] = 19.483700;
        expectedResult[61] = 21.447262;
        expectedResult[62] = 23.714941;
        expectedResult[63] = 26.324994;
        expectedResult[64] = 26.606541;
        expectedResult[65] = 26.892030;
        expectedResult[66] = 27.181523;
        expectedResult[67] = 27.475086;
        expectedResult[68] = 27.772775;
        expectedResult[69] = 28.074670;
        expectedResult[70] = 28.380833;
        expectedResult[71] = 28.691343;
        expectedResult[72] = 29.006280;
        expectedResult[73] = 29.325724;
        expectedResult[74] = 29.649773;
        expectedResult[75] = 29.978508;
        expectedResult[76] = 30.312033;
        expectedResult[77] = 30.650452;
        expectedResult[78] = 30.993870;
        expectedResult[79] = 31.342412;
        expectedResult[80] = 31.696189;
        expectedResult[81] = 32.055345;
        expectedResult[82] = 32.420008;
        expectedResult[83] = 32.790337;
        expectedResult[84] = 33.166479;
        expectedResult[85] = 33.548602;
        expectedResult[86] = 33.936894;
        expectedResult[87] = 34.331535;
        expectedResult[88] = 34.732729;
        expectedResult[89] = 35.140700;
        expectedResult[90] = 35.555670;
        expectedResult[91] = 35.977900;
        expectedResult[92] = 36.407647;
        expectedResult[93] = 36.845209;
        expectedResult[94] = 37.290884;
        expectedResult[95] = 37.745008;
        expectedResult[96] = 38.207940;
        expectedResult[97] = 38.680069;
        expectedResult[98] = 39.161818;
        expectedResult[99] = 39.653636;
        expectedResult[100] = 40.156019;
        expectedResult[101] = 40.669513;
        expectedResult[102] = 41.194698;
        expectedResult[103] = 41.732225;
        expectedResult[104] = 42.282802;
        expectedResult[105] = 42.847204;
        expectedResult[106] = 43.426290;
        expectedResult[107] = 44.021018;
        expectedResult[108] = 44.632441;
        expectedResult[109] = 45.261746;
        expectedResult[110] = 45.910262;
        expectedResult[111] = 46.579473;
        expectedResult[112] = 47.271073;
        expectedResult[113] = 47.986986;
        expectedResult[114] = 48.729419;
        expectedResult[115] = 49.500908;
        expectedResult[116] = 50.304413;
        expectedResult[117] = 51.143384;
        expectedResult[118] = 52.021915;
        expectedResult[119] = 52.944899;
        expectedResult[120] = 53.918243;
        expectedResult[121] = 54.949217;
        expectedResult[122] = 56.046852;
        expectedResult[123] = 57.222641;
        expectedResult[124] = 58.491505;
        expectedResult[125] = 59.873345;
        expectedResult[126] = 61.395599;
        expectedResult[127] = 63.097760;
        expectedResult[128] = 65.039770;
        expectedResult[129] = 67.319757;
        expectedResult[130] = 70.116604;
        expectedResult[131] = 73.818118;
        expectedResult[132] = 79.602053;
        expectedResult[133] = 80.429679;
        expectedResult[134] = 81.340449;
        expectedResult[135] = 82.355396;
        expectedResult[136] = 83.504800;
        expectedResult[137] = 84.835020;
        expectedResult[138] = 86.422496;
        expectedResult[139] = 88.407930;
        expectedResult[140] = 91.099600;
        expectedResult[141] = 95.447872;
        for (int pi = 0; pi < 142; pi++) {
            double result = calculator.bel(f,p[pi],cl,th);
            util.assertDoubleEquals(expectedResult[pi], result);
        }
    }

    @Test
    public void test3() {
        P2109 calculator = new P2109();
        double[] p = new double[142];
        double th = 45.000000;
        double f = 2.000000;
        int cl = 1;
        p[0] = 0.000010;
        p[1] = 0.000013;
        p[2] = 0.000016;
        p[3] = 0.000020;
        p[4] = 0.000025;
        p[5] = 0.000032;
        p[6] = 0.000040;
        p[7] = 0.000050;
        p[8] = 0.000063;
        p[9] = 0.000079;
        p[10] = 0.000100;
        p[11] = 0.000126;
        p[12] = 0.000158;
        p[13] = 0.000200;
        p[14] = 0.000251;
        p[15] = 0.000316;
        p[16] = 0.000398;
        p[17] = 0.000501;
        p[18] = 0.000631;
        p[19] = 0.000794;
        p[20] = 0.001000;
        p[21] = 0.001259;
        p[22] = 0.001585;
        p[23] = 0.001995;
        p[24] = 0.002512;
        p[25] = 0.003162;
        p[26] = 0.003981;
        p[27] = 0.005012;
        p[28] = 0.006310;
        p[29] = 0.007943;
        p[30] = 0.010000;
        p[31] = 0.012589;
        p[32] = 0.015849;
        p[33] = 0.019953;
        p[34] = 0.025119;
        p[35] = 0.031623;
        p[36] = 0.039811;
        p[37] = 0.050119;
        p[38] = 0.063096;
        p[39] = 0.079433;
        p[40] = 0.100000;
        p[41] = 0.125892;
        p[42] = 0.158489;
        p[43] = 0.199526;
        p[44] = 0.251189;
        p[45] = 0.316228;
        p[46] = 0.398107;
        p[47] = 0.501187;
        p[48] = 0.630957;
        p[49] = 0.794328;
        p[50] = 1.000000;
        p[51] = 1.258925;
        p[52] = 1.584893;
        p[53] = 1.995262;
        p[54] = 2.511886;
        p[55] = 3.162278;
        p[56] = 3.981072;
        p[57] = 5.011872;
        p[58] = 6.309573;
        p[59] = 7.943282;
        p[60] = 10.000000;
        p[61] = 12.589250;
        p[62] = 15.848930;
        p[63] = 19.952620;
        p[64] = 20.417380;
        p[65] = 20.892960;
        p[66] = 21.379620;
        p[67] = 21.877620;
        p[68] = 22.387210;
        p[69] = 22.908680;
        p[70] = 23.442290;
        p[71] = 23.988330;
        p[72] = 24.547090;
        p[73] = 25.118860;
        p[74] = 25.703960;
        p[75] = 26.302680;
        p[76] = 26.915350;
        p[77] = 27.542290;
        p[78] = 28.183830;
        p[79] = 28.840320;
        p[80] = 29.512090;
        p[81] = 30.199520;
        p[82] = 30.902950;
        p[83] = 31.622780;
        p[84] = 32.359370;
        p[85] = 33.113110;
        p[86] = 33.884420;
        p[87] = 34.673690;
        p[88] = 35.481340;
        p[89] = 36.307810;
        p[90] = 37.153520;
        p[91] = 38.018940;
        p[92] = 38.904510;
        p[93] = 39.810720;
        p[94] = 40.738030;
        p[95] = 41.686940;
        p[96] = 42.657950;
        p[97] = 43.651580;
        p[98] = 44.668360;
        p[99] = 45.708820;
        p[100] = 46.773510;
        p[101] = 47.863010;
        p[102] = 48.977880;
        p[103] = 50.118720;
        p[104] = 51.286140;
        p[105] = 52.480750;
        p[106] = 53.703180;
        p[107] = 54.954090;
        p[108] = 56.234130;
        p[109] = 57.543990;
        p[110] = 58.884370;
        p[111] = 60.255960;
        p[112] = 61.659500;
        p[113] = 63.095730;
        p[114] = 64.565420;
        p[115] = 66.069340;
        p[116] = 67.608300;
        p[117] = 69.183100;
        p[118] = 70.794580;
        p[119] = 72.443600;
        p[120] = 74.131020;
        p[121] = 75.857760;
        p[122] = 77.624710;
        p[123] = 79.432820;
        p[124] = 81.283050;
        p[125] = 83.176380;
        p[126] = 85.113800;
        p[127] = 87.096360;
        p[128] = 89.125090;
        p[129] = 91.201080;
        p[130] = 93.325430;
        p[131] = 95.499260;
        p[132] = 97.723720;
        p[133] = 97.949000;
        p[134] = 98.174790;
        p[135] = 98.401110;
        p[136] = 98.627950;
        p[137] = 98.855310;
        p[138] = 99.083190;
        p[139] = 99.311600;
        p[140] = 99.540540;
        p[141] = 99.770010;
        double[] expectedResult = new double[142];
        expectedResult[0] = -2.484444;
        expectedResult[1] = -2.464817;
        expectedResult[2] = -2.444290;
        expectedResult[3] = -2.422813;
        expectedResult[4] = -2.400332;
        expectedResult[5] = -2.376790;
        expectedResult[6] = -2.352125;
        expectedResult[7] = -2.326272;
        expectedResult[8] = -2.299158;
        expectedResult[9] = -2.270709;
        expectedResult[10] = -2.240841;
        expectedResult[11] = -2.209468;
        expectedResult[12] = -2.176492;
        expectedResult[13] = -2.141811;
        expectedResult[14] = -2.105314;
        expectedResult[15] = -2.066880;
        expectedResult[16] = -2.026377;
        expectedResult[17] = -1.983663;
        expectedResult[18] = -1.938582;
        expectedResult[19] = -1.890965;
        expectedResult[20] = -1.840627;
        expectedResult[21] = -1.787365;
        expectedResult[22] = -1.730958;
        expectedResult[23] = -1.671162;
        expectedResult[24] = -1.607709;
        expectedResult[25] = -1.540305;
        expectedResult[26] = -1.468623;
        expectedResult[27] = -1.392304;
        expectedResult[28] = -1.310950;
        expectedResult[29] = -1.224120;
        expectedResult[30] = -1.131324;
        expectedResult[31] = -1.032019;
        expectedResult[32] = -0.925601;
        expectedResult[33] = -0.811395;
        expectedResult[34] = -0.688652;
        expectedResult[35] = -0.556538;
        expectedResult[36] = -0.414120;
        expectedResult[37] = -0.260363;
        expectedResult[38] = -0.094112;
        expectedResult[39] = 0.085919;
        expectedResult[40] = 0.281154;
        expectedResult[41] = 0.493175;
        expectedResult[42] = 0.723729;
        expectedResult[43] = 0.974742;
        expectedResult[44] = 1.248329;
        expectedResult[45] = 1.546801;
        expectedResult[46] = 1.872675;
        expectedResult[47] = 2.228673;
        expectedResult[48] = 2.617727;
        expectedResult[49] = 3.042974;
        expectedResult[50] = 3.507756;
        expectedResult[51] = 4.015620;
        expectedResult[52] = 4.570319;
        expectedResult[53] = 5.175827;
        expectedResult[54] = 5.836374;
        expectedResult[55] = 6.556504;
        expectedResult[56] = 7.341174;
        expectedResult[57] = 8.195917;
        expectedResult[58] = 9.127086;
        expectedResult[59] = 10.142215;
        expectedResult[60] = 11.250561;
        expectedResult[61] = 12.463917;
        expectedResult[62] = 13.797894;
        expectedResult[63] = 15.273961;
        expectedResult[64] = 15.430464;
        expectedResult[65] = 15.588719;
        expectedResult[66] = 15.748769;
        expectedResult[67] = 15.910654;
        expectedResult[68] = 16.074413;
        expectedResult[69] = 16.240097;
        expectedResult[70] = 16.407746;
        expectedResult[71] = 16.577411;
        expectedResult[72] = 16.749143;
        expectedResult[73] = 16.922994;
        expectedResult[74] = 17.099023;
        expectedResult[75] = 17.277284;
        expectedResult[76] = 17.457840;
        expectedResult[77] = 17.640756;
        expectedResult[78] = 17.826098;
        expectedResult[79] = 18.013939;
        expectedResult[80] = 18.204350;
        expectedResult[81] = 18.397415;
        expectedResult[82] = 18.593213;
        expectedResult[83] = 18.791837;
        expectedResult[84] = 18.993374;
        expectedResult[85] = 19.197924;
        expectedResult[86] = 19.405595;
        expectedResult[87] = 19.616493;
        expectedResult[88] = 19.830735;
        expectedResult[89] = 20.048450;
        expectedResult[90] = 20.269765;
        expectedResult[91] = 20.494828;
        expectedResult[92] = 20.723785;
        expectedResult[93] = 20.956804;
        expectedResult[94] = 21.194051;
        expectedResult[95] = 21.435716;
        expectedResult[96] = 21.681997;
        expectedResult[97] = 21.933111;
        expectedResult[98] = 22.189292;
        expectedResult[99] = 22.450788;
        expectedResult[100] = 22.717871;
        expectedResult[101] = 22.990842;
        expectedResult[102] = 23.270018;
        expectedResult[103] = 23.555754;
        expectedResult[104] = 23.848438;
        expectedResult[105] = 24.148490;
        expectedResult[106] = 24.456377;
        expectedResult[107] = 24.772619;
        expectedResult[108] = 25.097786;
        expectedResult[109] = 25.432523;
        expectedResult[110] = 25.777545;
        expectedResult[111] = 26.133655;
        expectedResult[112] = 26.501767;
        expectedResult[113] = 26.882918;
        expectedResult[114] = 27.278297;
        expectedResult[115] = 27.689270;
        expectedResult[116] = 28.117429;
        expectedResult[117] = 28.564631;
        expectedResult[118] = 29.033075;
        expectedResult[119] = 29.525392;
        expectedResult[120] = 30.044756;
        expectedResult[121] = 30.595072;
        expectedResult[122] = 31.181191;
        expectedResult[123] = 31.809285;
        expectedResult[124] = 32.487363;
        expectedResult[125] = 33.226112;
        expectedResult[126] = 34.040260;
        expectedResult[127] = 34.951006;
        expectedResult[128] = 35.990526;
        expectedResult[129] = 37.211492;
        expectedResult[130] = 38.709919;
        expectedResult[131] = 40.693971;
        expectedResult[132] = 43.795851;
        expectedResult[133] = 44.239826;
        expectedResult[134] = 44.728435;
        expectedResult[135] = 45.272967;
        expectedResult[136] = 45.889678;
        expectedResult[137] = 46.603457;
        expectedResult[138] = 47.455339;
        expectedResult[139] = 48.520863;
        expectedResult[140] = 49.965535;
        expectedResult[141] = 52.299593;
        for (int pi = 0; pi < 142; pi++) {
            double result = calculator.bel(f,p[pi],cl,th);
            util.assertDoubleEquals(expectedResult[pi], result);
        }
    }


    @Test
    public void test4() {
        P2109 calculator = new P2109();
        double[] p = new double[142];
        double th = 45.000000;
        double f = 2.000000;
        int cl = 2;
        p[0] = 0.000010;
        p[1] = 0.000013;
        p[2] = 0.000016;
        p[3] = 0.000020;
        p[4] = 0.000025;
        p[5] = 0.000032;
        p[6] = 0.000040;
        p[7] = 0.000050;
        p[8] = 0.000063;
        p[9] = 0.000079;
        p[10] = 0.000100;
        p[11] = 0.000126;
        p[12] = 0.000158;
        p[13] = 0.000200;
        p[14] = 0.000251;
        p[15] = 0.000316;
        p[16] = 0.000398;
        p[17] = 0.000501;
        p[18] = 0.000631;
        p[19] = 0.000794;
        p[20] = 0.001000;
        p[21] = 0.001259;
        p[22] = 0.001585;
        p[23] = 0.001995;
        p[24] = 0.002512;
        p[25] = 0.003162;
        p[26] = 0.003981;
        p[27] = 0.005012;
        p[28] = 0.006310;
        p[29] = 0.007943;
        p[30] = 0.010000;
        p[31] = 0.012589;
        p[32] = 0.015849;
        p[33] = 0.019953;
        p[34] = 0.025119;
        p[35] = 0.031623;
        p[36] = 0.039811;
        p[37] = 0.050119;
        p[38] = 0.063096;
        p[39] = 0.079433;
        p[40] = 0.100000;
        p[41] = 0.125892;
        p[42] = 0.158489;
        p[43] = 0.199526;
        p[44] = 0.251189;
        p[45] = 0.316228;
        p[46] = 0.398107;
        p[47] = 0.501187;
        p[48] = 0.630957;
        p[49] = 0.794328;
        p[50] = 1.000000;
        p[51] = 1.258925;
        p[52] = 1.584893;
        p[53] = 1.995262;
        p[54] = 2.511886;
        p[55] = 3.162278;
        p[56] = 3.981072;
        p[57] = 5.011872;
        p[58] = 6.309573;
        p[59] = 7.943282;
        p[60] = 10.000000;
        p[61] = 12.589250;
        p[62] = 15.848930;
        p[63] = 19.952620;
        p[64] = 20.417380;
        p[65] = 20.892960;
        p[66] = 21.379620;
        p[67] = 21.877620;
        p[68] = 22.387210;
        p[69] = 22.908680;
        p[70] = 23.442290;
        p[71] = 23.988330;
        p[72] = 24.547090;
        p[73] = 25.118860;
        p[74] = 25.703960;
        p[75] = 26.302680;
        p[76] = 26.915350;
        p[77] = 27.542290;
        p[78] = 28.183830;
        p[79] = 28.840320;
        p[80] = 29.512090;
        p[81] = 30.199520;
        p[82] = 30.902950;
        p[83] = 31.622780;
        p[84] = 32.359370;
        p[85] = 33.113110;
        p[86] = 33.884420;
        p[87] = 34.673690;
        p[88] = 35.481340;
        p[89] = 36.307810;
        p[90] = 37.153520;
        p[91] = 38.018940;
        p[92] = 38.904510;
        p[93] = 39.810720;
        p[94] = 40.738030;
        p[95] = 41.686940;
        p[96] = 42.657950;
        p[97] = 43.651580;
        p[98] = 44.668360;
        p[99] = 45.708820;
        p[100] = 46.773510;
        p[101] = 47.863010;
        p[102] = 48.977880;
        p[103] = 50.118720;
        p[104] = 51.286140;
        p[105] = 52.480750;
        p[106] = 53.703180;
        p[107] = 54.954090;
        p[108] = 56.234130;
        p[109] = 57.543990;
        p[110] = 58.884370;
        p[111] = 60.255960;
        p[112] = 61.659500;
        p[113] = 63.095730;
        p[114] = 64.565420;
        p[115] = 66.069340;
        p[116] = 67.608300;
        p[117] = 69.183100;
        p[118] = 70.794580;
        p[119] = 72.443600;
        p[120] = 74.131020;
        p[121] = 75.857760;
        p[122] = 77.624710;
        p[123] = 79.432820;
        p[124] = 81.283050;
        p[125] = 83.176380;
        p[126] = 85.113800;
        p[127] = 87.096360;
        p[128] = 89.125090;
        p[129] = 91.201080;
        p[130] = 93.325430;
        p[131] = 95.499260;
        p[132] = 97.723720;
        p[133] = 97.949000;
        p[134] = 98.174790;
        p[135] = 98.401110;
        p[136] = 98.627950;
        p[137] = 98.855310;
        p[138] = 99.083190;
        p[139] = 99.311600;
        p[140] = 99.540540;
        p[141] = 99.770010;
        double[] expectedResult = new double[142];
        expectedResult[0] = -2.882419;
        expectedResult[1] = -2.871842;
        expectedResult[2] = -2.860230;
        expectedResult[3] = -2.847473;
        expectedResult[4] = -2.833448;
        expectedResult[5] = -2.818022;
        expectedResult[6] = -2.801042;
        expectedResult[7] = -2.782342;
        expectedResult[8] = -2.761734;
        expectedResult[9] = -2.739010;
        expectedResult[10] = -2.713939;
        expectedResult[11] = -2.686262;
        expectedResult[12] = -2.655692;
        expectedResult[13] = -2.621911;
        expectedResult[14] = -2.584563;
        expectedResult[15] = -2.543254;
        expectedResult[16] = -2.497547;
        expectedResult[17] = -2.446955;
        expectedResult[18] = -2.390943;
        expectedResult[19] = -2.328917;
        expectedResult[20] = -2.260224;
        expectedResult[21] = -2.184145;
        expectedResult[22] = -2.099892;
        expectedResult[23] = -2.006605;
        expectedResult[24] = -1.903347;
        expectedResult[25] = -1.789103;
        expectedResult[26] = -1.662778;
        expectedResult[27] = -1.523200;
        expectedResult[28] = -1.369120;
        expectedResult[29] = -1.199216;
        expectedResult[30] = -1.012100;
        expectedResult[31] = -0.806330;
        expectedResult[32] = -0.580414;
        expectedResult[33] = -0.332831;
        expectedResult[34] = -0.062041;
        expectedResult[35] = 0.233497;
        expectedResult[36] = 0.555310;
        expectedResult[37] = 0.904898;
        expectedResult[38] = 1.283721;
        expectedResult[39] = 1.693189;
        expectedResult[40] = 2.134666;
        expectedResult[41] = 2.609465;
        expectedResult[42] = 3.118870;
        expectedResult[43] = 3.664146;
        expectedResult[44] = 4.246572;
        expectedResult[45] = 4.867475;
        expectedResult[46] = 5.528268;
        expectedResult[47] = 6.230510;
        expectedResult[48] = 6.975955;
        expectedResult[49] = 7.766615;
        expectedResult[50] = 8.604836;
        expectedResult[51] = 9.493370;
        expectedResult[52] = 10.435473;
        expectedResult[53] = 11.434997;
        expectedResult[54] = 12.496525;
        expectedResult[55] = 13.625520;
        expectedResult[56] = 14.828514;
        expectedResult[57] = 16.113376;
        expectedResult[58] = 17.489663;
        expectedResult[59] = 18.969114;
        expectedResult[60] = 20.566386;
        expectedResult[61] = 22.300148;
        expectedResult[62] = 24.194829;
        expectedResult[63] = 26.283450;
        expectedResult[64] = 26.504619;
        expectedResult[65] = 26.728228;
        expectedResult[66] = 26.954340;
        expectedResult[67] = 27.183017;
        expectedResult[68] = 27.414315;
        expectedResult[69] = 27.648309;
        expectedResult[70] = 27.885061;
        expectedResult[71] = 28.124646;
        expectedResult[72] = 28.367139;
        expectedResult[73] = 28.612615;
        expectedResult[74] = 28.861165;
        expectedResult[75] = 29.112865;
        expectedResult[76] = 29.367810;
        expectedResult[77] = 29.626093;
        expectedResult[78] = 29.887813;
        expectedResult[79] = 30.153077;
        expectedResult[80] = 30.421988;
        expectedResult[81] = 30.694670;
        expectedResult[82] = 30.971235;
        expectedResult[83] = 31.251823;
        expectedResult[84] = 31.536560;
        expectedResult[85] = 31.825589;
        expectedResult[86] = 32.119069;
        expectedResult[87] = 32.417154;
        expectedResult[88] = 32.720014;
        expectedResult[89] = 33.027835;
        expectedResult[90] = 33.340803;
        expectedResult[91] = 33.659131;
        expectedResult[92] = 33.983030;
        expectedResult[93] = 34.312743;
        expectedResult[94] = 34.648512;
        expectedResult[95] = 34.990609;
        expectedResult[96] = 35.339322;
        expectedResult[97] = 35.694964;
        expectedResult[98] = 36.057869;
        expectedResult[99] = 36.428399;
        expectedResult[100] = 36.806944;
        expectedResult[101] = 37.193937;
        expectedResult[102] = 37.589835;
        expectedResult[103] = 37.995149;
        expectedResult[104] = 38.410436;
        expectedResult[105] = 38.836302;
        expectedResult[106] = 39.273418;
        expectedResult[107] = 39.722531;
        expectedResult[108] = 40.184461;
        expectedResult[109] = 40.660131;
        expectedResult[110] = 41.150573;
        expectedResult[111] = 41.656937;
        expectedResult[112] = 42.180538;
        expectedResult[113] = 42.722862;
        expectedResult[114] = 43.285617;
        expectedResult[115] = 43.870764;
        expectedResult[116] = 44.480586;
        expectedResult[117] = 45.117748;
        expectedResult[118] = 45.785408;
        expectedResult[119] = 46.487338;
        expectedResult[120] = 47.228093;
        expectedResult[121] = 48.013275;
        expectedResult[122] = 48.849840;
        expectedResult[123] = 49.746644;
        expectedResult[124] = 50.715176;
        expectedResult[125] = 51.770762;
        expectedResult[126] = 52.934531;
        expectedResult[127] = 54.236890;
        expectedResult[128] = 55.723990;
        expectedResult[129] = 57.471386;
        expectedResult[130] = 59.616810;
        expectedResult[131] = 62.458878;
        expectedResult[132] = 66.904563;
        expectedResult[133] = 67.541070;
        expectedResult[134] = 68.241612;
        expectedResult[135] = 69.022390;
        expectedResult[136] = 69.906726;
        expectedResult[137] = 70.930333;
        expectedResult[138] = 72.152093;
        expectedResult[139] = 73.680398;
        expectedResult[140] = 75.752745;
        expectedResult[141] = 79.101337;
        for (int pi = 0; pi < 142; pi++) {
            double result = calculator.bel(f,p[pi],cl,th);
            util.assertDoubleEquals(expectedResult[pi], result);
        }
    }

}




